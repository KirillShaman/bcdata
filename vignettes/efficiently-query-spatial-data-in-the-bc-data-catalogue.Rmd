---
title: "Querying Spatial Data with bcdata"
author: "Sam Albers"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# WORK IN PROGRESS

## Getting Started
First you need to load the package. We will also load the `sf` package to help us wokr with spatial data. You can learn more about the `sf` package [here](https://r-spatial.github.io/sf/):
```{r}
library(bcdata)
library(sf)
```


## Geospatial Data in the BC Data Catalogue
The BC Data Catalogue provides many datasets with spatial information over the web via a web feature service (wfs). Technically speaking, this means if we have an internet connection we can issue http requests to the wfs of the BC Data Catalogue and import the response data into R as an sf object very easily. In practice what it means is that all spatial datasets are available to users of bcdata as sf objects in R. The `bcdata` package provides a means to chose which layer you want and `dplyr` verbs to specifically tailor your request.  A `dbplyr` backend is implemented so that requests are executed lazily. This approach mimics the `dplyr` verb translation to `SQL` seen for many database types. A good introduction to `dbplyr` is available [here] (https://cran.r-project.org/web/packages/dbplyr/vignettes/dbplyr.html).

### Using dplyr verbs to fine tune your query
For the purposes of this example, let's consider [this](catalogue.data.gov.bc.ca/dataset/6a2fea1b-0cc4-4fc2-8017-eaf755d516da) layer in the catalogue. This layer is described here:
```{r}
bcdc_get_record("6a2fea1b-0cc4-4fc2-8017-eaf755d516da")
```

The key thing we are interested in here is that this is a *wfs record*. From this we know we can make use of `bcdc_query_geodata`.

```{r}
bcdc_query_geodata("6a2fea1b-0cc4-4fc2-8017-eaf755d516da")
```



